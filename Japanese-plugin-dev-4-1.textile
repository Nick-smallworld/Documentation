h1. 独自オブジェクトの作成

h1. +はじめに+

前章でMTオブジェクトの利用方法について解説しましたが、既存の物だけではなく自分でもMTオブジェクトを作成する事ができます。

今回は、こういった独自オブジェクトの作成について解説します。

h1. +独自オブジェクトとは？+

MT::Objectから派生させた、独自のMTオブジェクトの事をさします。

プラグインでMTオブジェクトを追加する場合は、config.yamlでのオブジェクト情報の記載と、MTオブジェクトのPerlモジュールが必要となります。

h1. +独自オブジェクトの作成+

独自オブジェクト（MT::Foo）の作成法を解説します。

h2. MT::Fooの仕様

* @MT::Object@ を継承したクラス
* モジュール名は @MT::Foo@
* タイプ名は @foo@
* カラム
** id : オブジェクトID
** blog_id : ブログID
** title : タイトル（最大２５５文字）
** bar : テキスト情報（サイズ限定なし）
** created_on : 作成時間
** modified_on : 修正時間
* インデックス
** blog_id
** created_on
** modified_on
* データソース : mt_foo
* プライマリキー : id

h2. config.yaml

<pre>
id: MyPlugin11
key: MyPlugin11
name: <__trans phrase="Sample Plugin Uniquely Object">
version: 1.0
description: <__trans phrase="_PLUGIN_DESCRIPTION">
author_name: <__trans phrase="_PLUGIN_AUTHOR">
author_link: http://www.example.com/about/
doc_link: http://www.example.com/docs/
l10n_class: MyPlugin11::L10N

schema_version: 0.01
object_types:
    foo: MT::Foo
</pre>

h2. MT/Foo.pm

<pre>
package MT::Foo;
use strict;

use base qw( MT::Object );

__PACKAGE__->install_properties ({
    column_defs => {
        'id'      => 'integer not null auto_increment',
        'blog_id' => 'integer not null',
        'title'   => 'string(255) not null',
        'bar'     => 'text',
    },
    indexes => {
        blog_id => 1,
        created_on => 1,
        modified_on => 1,
    },
    audit => 1,
    datasource  => 'foo',
    primary_key => 'id',
    class_type  => 'foo',
});

1;
</pre>

h2. ファイルの配置

<pre>
$MT_DIR/
|__ plugins/
   |__ MyPlugin11/
      |__ config.yaml
      |__ lib/
         |＿ MyPlugin11/
         |  |__ L10N.pm
         |  |＿ L10N/
         |     |＿ en_us.pm
         |     |＿ ja.pm
         |＿ MT
            |__ Foo.pm
</pre>

h1. +MT::Fooの利用方法+

h2. インスタンスの作成

h2. 値の設定

h2. 値の取得

h2. インスタンスの削除

h1. +プラグインダウンロード+

[[MyPlugin11.zip(2.39KB)|https://github.com/movabletype/Documentation/raw/master/assets/Japanese-plugin-dev/files/MyPlugin11.zip]]

h1. +まとめ+

h1. +プラグイン開発ガイド インデックス+

# [[プラグイン開発のためのファーストステップ|Japanese-plugin-dev-1-1]]
# [[レジストリ、YAMLについて|Japanese-plugin-dev-1-2]]
# [[環境変数について|Japanese-plugin-dev-1-3]]
# [[プラグインのローカライゼーションについて|Japanese-plugin-dev-1-4]]
# [[テストドリブンでのプラグインの開発について|Japanese-plugin-dev-1-5]]
# [[グローバル・モディファイアプラグインの開発について|Japanese-plugin-dev-1-6]]
# [[ファンクションタグ プラグインの開発について|Japanese-plugin-dev-2-1]]
# [[ブロックタグ プラグインの開発について|Japanese-plugin-dev-2-2]]
# [[コンディショナルタグ プラグインの開発について|Japanese-plugin-dev-2-3]]
# [[プラグインのデバッグ|Japanese-plugin-dev-2-4]]
# [[プラグインの設定方法|Japanese-plugin-dev-3-1]]
# [[コールバックとフックポイント|Japanese-plugin-dev-3-2]]
# [[スケジュールタスクの開発|Japanese-plugin-dev-3-3]]
# [[MTオブジェクトの利用方法|Japanese-plugin-dev-3-4]]
# 独自オブジェクトの作成